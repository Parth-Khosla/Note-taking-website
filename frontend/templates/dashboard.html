{% extends 'base.html' %}

{% block title %}Dashboard - NoteVault{% endblock %}

{% block content %}
    <section class="dashboard">
        <header class="dashboard-header">
            <h2>Welcome, {{ username }}</h2>
            <p class="actions"><a class="btn" href="{{ url_for('create_note') }}">Create New Note</a> <a class="btn btn-outline" href="{{ url_for('logout') }}">Logout</a></p>
        </header>

        <h3>Your Notes</h3>
        {% if notes %}
            <ul class="note-list">
                {% for note in notes %}
                    <li class="note-item">
                        <div class="note-meta">{{ note.note_type }} — <time>{{ note.timestamp }}</time></div>
                        {% if note.title %}
                          <h4 class="note-title">{{ note.title }} — {{ note.note_type }} ({{ note.timestamp }})</h4>
                        {% endif %}
                        {% if note.content and not (note.file_url or note.file_path) %}
                            <p class="note-content">{{ note.content }}</p>
                        {% elif note.file_url or note.file_path %}
                            {% if note.file_url %}
                                <p><a href="{{ note.file_url }}" class="btn btn-sm">View File</a></p>
                            {% else %}
                                <p><a href="/{{ note.file_path }}" class="btn btn-sm">View File</a></p>
                            {% endif %}
                            {% if note.extracted_text %}
                                <details>
                                  <summary>Show extracted text</summary>
                                  <pre>{{ note.extracted_text[:1000] }}</pre>
                                </details>
                            {% endif %}
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="muted">No notes found.</p>
        {% endif %}
    </section>
{% endblock %}
